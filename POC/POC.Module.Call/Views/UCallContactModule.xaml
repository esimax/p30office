<UserControl x:Class="POC.Module.Call.Views.UCallContactModule"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:pol_ap="clr-namespace:POL.WPF.Controles.AttachProperties;assembly=POL.WPF.Controles"
             xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
             xmlns:dxr="http://schemas.devexpress.com/winfx/2008/xaml/ribbon"
             xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
             xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
             xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
             xmlns:dxp="http://schemas.devexpress.com/winfx/2008/xaml/printing"
             xmlns:pol_comm="clr-namespace:POL.Lib.Common;assembly=POL.Lib.Common" mc:Ignorable="d" 
             d:DesignHeight="413" d:DesignWidth="478">



    <UserControl.Resources>
        <ResourceDictionary>
            <!--<ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/POL.WPF.DXControls;component/Resources/RTLGridPrintingTemplates.xaml" />
            </ResourceDictionary.MergedDictionaries>
            <DataTemplate x:Key="toolbarCustomization">
                <dxb:BarManagerActionContainer>
                    <dxb:RemoveBarItemAndLinkAction ItemName="exportToWindow" />
                    <dxb:RemoveBarItemAndLinkAction ItemName="open" />
                    <dxb:RemoveBarItemAndLinkAction ItemName="save" />
                    <dxb:RemoveBarItemAndLinkAction ItemName="email" />
                </dxb:BarManagerActionContainer>
            </DataTemplate>-->
            <!--<dxp:DocumentPreview x:Key="documentPreview" dxp:BarManagerCustomization.Template="{StaticResource toolbarCustomization}" />
            <DataTemplate x:Key="reportHeaderTemplate">
                <dxe:TextEdit IsPrintingMode="True" 
                                  Background="#FF6D8C59" 
                                  HorizontalAlignment="Stretch" 
                                  VerticalAlignment="Stretch" 
                                  Padding="12" 
                                  Margin="0,0,0,8" 
                                  Width="{Binding UsablePageWidth}"
                                  Foreground="#FFFFFFFF" 
                                  FontWeight="Bold" 
                                  FontSize="20" 
                                  HorizontalContentAlignment="Center" 
                                  FontFamily="B Titr"
                                  EditValue="{Binding Content.WindowTitle, Mode=OneWay}" 
                                  FlowDirection="RightToLeft"/>
            </DataTemplate>-->

            <!--<DataTemplate x:Key="ChartTemplate">
                <Grid>
                    <StackPanel>
                        <dxe:ImageEdit IsPrintingMode="True" Source="{Binding Content}" />
                    </StackPanel>
                </Grid>
            </DataTemplate>-->

            <!--<poc_conv:ConvDummy x:Key="dummy"/>-->
            <!--<BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>-->


            <pol_comm:ConvCallDate x:Key="convCallDate"/>
            <!--<pol_comm:ConvCallTeleCode x:Key="convTeleCode"/>-->
            <pol_comm:ConvCallDuration x:Key="convDurationSeconds"/>
            <pol_comm:ConvCallLine x:Key="convLine"/>
            <pol_comm:ConvCallType x:Key="convCallType"/>
            <pol_comm:ConvCallExtToName x:Key="convCallExtToName"/>
            <pol_comm:ConvCallExtToBrush x:Key="convCallExtToBrush"/>
            <pol_comm:ConvCallNoteFlag x:Key="convCallNoteFlag"/>
            <pol_comm:ConvCallRecordTag x:Key="convRecordTag"/>
            <pol_comm:ConvCallRecordRole x:Key="convCallRecordRole"/>


            <DataTemplate x:Key="ctCallType">
                <Ellipse Fill="{Binding DataContext.Value, Converter={StaticResource convCallType}, RelativeSource={RelativeSource TemplatedParent}}" Height="16" Width="16" StrokeThickness="1" Stroke="Black"/>
            </DataTemplate>
            <DataTemplate x:Key="ctCallRecordTag">
                <Image Width="16" Height="16"  Stretch="Fill" SnapsToDevicePixels="True"
                       Visibility="{Binding DataContext.Value, Converter={StaticResource convRecordTag}, RelativeSource={RelativeSource TemplatedParent}}"
                       Source="pack://application:,,,/POL.Lib.Resources;component/Special/16/_16_Speaker.png"/>
            </DataTemplate>
            <DataTemplate x:Key="ctCallRecordRole">
                <Image Width="16" Height="16"  Stretch="Fill" SnapsToDevicePixels="True"
                       Source="{Binding DataContext.Value, Converter={StaticResource convCallRecordRole}, RelativeSource={RelativeSource TemplatedParent}}"/>
            </DataTemplate>


            <DataTemplate x:Key="ctCallDate">
                <TextBlock
                    Margin="3,1"
                    VerticalAlignment="Center"
                    HorizontalAlignment="Right"
                    FlowDirection="LeftToRight"
                    Text="{Binding DataContext.Value, Converter={StaticResource convCallDate}, RelativeSource={RelativeSource TemplatedParent}}"/>
            </DataTemplate>
            <!--<DataTemplate x:Key="ctTeleCode">
                <TextBlock
                    Margin="3,1"
                    VerticalAlignment="Center"
                    HorizontalAlignment="Right"
                    FlowDirection="LeftToRight"

                    Text="{Binding DataContext.Value, Converter={StaticResource convTeleCode}, RelativeSource={RelativeSource TemplatedParent}}"
                />
            </DataTemplate>-->
            <DataTemplate x:Key="ctDurationSeconds">
                <TextBlock
                    Margin="3,1"
                    VerticalAlignment="Center"
                    HorizontalAlignment="Right"
                    FlowDirection="LeftToRight"
                    Text="{Binding DataContext.Value, Converter={StaticResource convDurationSeconds}, RelativeSource={RelativeSource TemplatedParent}}"
                    />
            </DataTemplate>
            <DataTemplate x:Key="ctLine">
                <TextBlock
                    Margin="3,1"
                    VerticalAlignment="Center"
                    HorizontalAlignment="Right"
                    FlowDirection="LeftToRight"
                    Text="{Binding DataContext.Value, Converter={StaticResource convLine}, RelativeSource={RelativeSource TemplatedParent}}"/>
            </DataTemplate>
            <DataTemplate x:Key="ctCallExtToName">
                <TextBlock
                    Margin="3,1"
                    VerticalAlignment="Center"                   
                    Background="{Binding DataContext.Value, Converter={StaticResource convCallExtToBrush}, RelativeSource={RelativeSource TemplatedParent}}"
                    Text="{Binding DataContext.Value, Converter={StaticResource convCallExtToName}, RelativeSource={RelativeSource TemplatedParent}}"
                />
            </DataTemplate>
            <DataTemplate x:Key="ctNoteFlag">
                <Image Width="16" Height="16" Source="{Binding DataContext.Value, Converter={StaticResource convCallNoteFlag}, RelativeSource={RelativeSource TemplatedParent}}"/>
            </DataTemplate>





            <!--<DataTemplate x:Key="detailPrintHeaderTemplate">
                <dxe:TextEdit IsPrintingMode="True" Background="#FF6D8C59" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Padding="12" 
                              Margin="0,0,0,8" Width="{Binding Path=Content.(dxg:GridPrintingHelper.PrintRowInfo).TotalHeaderWidth}"
                               Foreground="#FFFFFFFF" FontWeight="Bold" FontSize="20" HorizontalContentAlignment="Center" EditValue="Employee List" />
            </DataTemplate>-->


        </ResourceDictionary>
    </UserControl.Resources>





    <dxb:BarManager IsEnabled="{Binding RootEnable}">
        <dxb:BarManager.Items>
            <dxb:BarButtonItem Content="بازخوانی" Name="biRefresh" 
                               Command="{Binding CommandRefresh}" 
                               LargeGlyph="pack://application:,,,/POL.Lib.Resources;component/Standard/32/_32_Refresh.png" 
                               />
            <dxb:BarButtonItem Content="ثبت نكته" Name="biSetCallNote" 
                               Command="{Binding CommandSetCallNote}" 
                               Glyph="pack://application:,,,/POL.Lib.Resources;component/Standard/16/_16_FlagGreen.png" 
                               LargeGlyph="pack://application:,,,/POL.Lib.Resources;component/Standard/32/_32_FlagGreen.png" 
                               />
            <dxb:BarCheckItem Content="همه تماس ها" Name="biShowAll" IsChecked="{Binding IsShowAll}"
                              Command="{Binding CommandShowAll}" Glyph="pack://application:,,,/POL.Lib.Resources;component/Special/16/_16_CallAll.png" BarItemDisplayMode="ContentAndGlyph"/>
            <dxb:BarCheckItem Content="فقط ارسالی" Name="biShowCallOut" IsChecked="{Binding IsShowCallOut}"
                              Command="{Binding CommandShowCallOut}" Glyph="pack://application:,,,/POL.Lib.Resources;component/Special/16/_16_CallOut.png" BarItemDisplayMode="ContentAndGlyph"/>
            <dxb:BarCheckItem Content="فقط دریافتی" Name="biShowCallIn" IsChecked="{Binding IsShowCallIn}"
                              Command="{Binding CommandShowCallIn}" Glyph="pack://application:,,,/POL.Lib.Resources;component/Special/16/_16_CallIn.png" BarItemDisplayMode="ContentAndGlyph"/>

            <dxb:BarButtonItem Content="حذف" Name="biCallDeleteSingle" 
                               Command="{Binding CommandCallDeleteSingle}" 
                               Glyph="pack://application:,,,/POL.Lib.Resources;component/Standard/16/_16_Delete2.png" 
                               GlyphSize="Small" BarItemDisplayMode="ContentAndGlyph"
                               />
            <dxb:BarButtonItem Content="حذف همه" Name="biCallDeleteAll" 
                               Command="{Binding CommandCallDeleteAll}" 
                               Glyph="pack://application:,,,/POL.Lib.Resources;component/Standard/16/_16_Delete2.png" 
                               GlyphSize="Small" BarItemDisplayMode="ContentAndGlyph"/>

            <dxb:BarButtonItem Content="چاپ" Name="biPrint" Command="{Binding CommandPrint}" LargeGlyph="pack://application:,,,/POL.Lib.Resources;component/Standard/32/_32_Printer.png"/>


            <dxb:BarButtonItem Content="پخش صدا" Name="biVoicePlay"
                               Command="{Binding CommandVoicePlay}" 
                               Glyph="pack://application:,,,/POL.Lib.Resources;component/Standard/16/_16_Play.png" 
                               LargeGlyph="pack://application:,,,/POL.Lib.Resources;component/Standard/32/_32_Play.png" />

            <dxb:BarButtonItem Content="حذف صدا" Name="biVoiceDelete"
                               Command="{Binding CommandVoiceDelete}" 
                               Glyph="pack://application:,,,/POL.Lib.Resources;component/Standard/16/_16_delete2.png" 
                               LargeGlyph="pack://application:,,,/POL.Lib.Resources;component/Standard/32/_32_delete2.png" />

            <dxb:BarButtonItem Content="ذخیره صدا" Name="biVoiceSave"
                               Command="{Binding CommandVoiceSave}" 
                               Glyph="pack://application:,,,/POL.Lib.Resources;component/Standard/16/_16_Save.png" 
                               LargeGlyph="pack://application:,,,/POL.Lib.Resources;component/Standard/32/_32_save.png" />

            <dxb:BarButtonItem Content="قانون اول" Name="biVoiceRole1"
                               Command="{Binding CommandVoiceRole1}" 
                               Glyph="pack://application:,,,/POL.Lib.Resources;component/Standard/16/_16_WhiteCircle.png" 
                               LargeGlyph="pack://application:,,,/POL.Lib.Resources;component/Standard/32/_32_WhiteCircle.png" />
            <dxb:BarButtonItem Content="قانون دوم" Name="biVoiceRole2"
                               Command="{Binding CommandVoiceRole2}" 
                               Glyph="pack://application:,,,/POL.Lib.Resources;component/Standard/16/_16_yellowCircle.png" 
                               LargeGlyph="pack://application:,,,/POL.Lib.Resources;component/Standard/32/_32_YellowCircle.png" />
            <dxb:BarButtonItem Content="قانون سوم" Name="biVoiceRole3"
                               Command="{Binding CommandVoiceRole3}" 
                               Glyph="pack://application:,,,/POL.Lib.Resources;component/Standard/16/_16_RedCircle.png" 
                               LargeGlyph="pack://application:,,,/POL.Lib.Resources;component/Standard/32/_32_RedCircle.png" />
            <dxb:BarButtonItem Content="راهنما" Name="biHelp" Command="{Binding CommandHelp}" LargeGlyph="pack://application:,,,/POL.Lib.Resources;component/Standard/32/_32_Help.png"/>
        </dxb:BarManager.Items>


        <Grid  pol_ap:ApGrid.RowDefinitions="auto,*">
            <dxr:RibbonControl x:Name="callRibbon" Grid.Row="0" RibbonStyle="Office2010">
                <!--<dxr:RibbonDefaultPageCategory>-->
                <dxr:RibbonPageCategory Name="rpcCall">
                    <dxr:RibbonPage Name="rpCall" Caption="تماس ها" MergeOrder="4">
                        <!--MergeOrder="7"-->
                        <dxr:RibbonPageGroup Caption="فیلتر" ShowCaptionButton="False">
                            <dxb:BarButtonItemLink BarItemName="biRefresh"/>
                            <dxb:BarButtonItemLink BarItemName="biSetCallNote"/>
                            <dxb:BarItemLinkSeparator/>
                            <dxb:BarCheckItemLink BarItemName="biShowAll" />
                            <dxb:BarCheckItemLink BarItemName="biShowCallOut" />
                            <dxb:BarCheckItemLink BarItemName="biShowCallIn" />
                        </dxr:RibbonPageGroup>
                        <dxr:RibbonPageGroup Caption="مدیریت" ShowCaptionButton="False">
                            <dxb:BarButtonItemLink BarItemName="biCallDeleteSingle"/>
                            <dxb:BarButtonItemLink BarItemName="biCallDeleteAll"/>
                        </dxr:RibbonPageGroup>
                        <dxr:RibbonPageGroup Caption="راهنما" >
                            <dxb:BarButtonItemLink BarItemName="biHelp" />
                        </dxr:RibbonPageGroup>
                        <!--<dxr:RibbonPageGroup Caption="گزارش" >
                            <dxb:BarButtonItemLink BarItemName="biPrint" />
                        </dxr:RibbonPageGroup>-->
                    </dxr:RibbonPage>
                    <dxr:RibbonPage Name="rpRecord" Caption="ضبط مكالمه" MergeOrder="5">
                        <!--MergeOrder="8"-->
                        <dxr:RibbonPageGroup Caption="ضبط" ShowCaptionButton="False">
                            <dxb:BarButtonItemLink BarItemName="biVoicePlay"/>
                            <dxb:BarButtonItemLink BarItemName="biVoiceSave"/>
                            <dxb:BarButtonItemLink BarItemName="biVoiceDelete"/>
                            <dxb:BarItemLinkSeparator/>
                            <dxb:BarButtonItemLink BarItemName="biVoiceRole1" />
                            <dxb:BarButtonItemLink BarItemName="biVoiceRole2" />
                            <dxb:BarButtonItemLink BarItemName="biVoiceRole3" />
                        </dxr:RibbonPageGroup>
                    </dxr:RibbonPage>
                    <!--</dxr:RibbonDefaultPageCategory>-->
                </dxr:RibbonPageCategory>
            </dxr:RibbonControl>
            <dxg:GridControl Grid.Row="1"  ItemsSource="{Binding CallList}" Name="gridCall" >
                <dxg:GridControl.TotalSummary>
                    <dxg:GridSummaryItem FieldName="CallDate" ShowInColumn="CallDate" SummaryType="Count" DisplayFormat=" {0}" />
                </dxg:GridControl.TotalSummary>
                <dxg:GridControl.Columns>
                    <dxg:GridColumn FieldName="CallType" Header=""  Name="colCallType" CellTemplate="{StaticResource ctCallType}" Width="24" FixedWidth="True" Fixed="Left" ColumnChooserHeaderCaption="نوع تماس" >
                        <dxg:GridColumn.FilterEditorHeaderTemplate>
                            <DataTemplate>
                                <TextBlock Text="نوع تماس"/>
                            </DataTemplate>
                        </dxg:GridColumn.FilterEditorHeaderTemplate>
                    </dxg:GridColumn>

                    <dxg:GridColumn FieldName="CallDate" Header="تاریخ" Name="colDate" CellTemplate="{StaticResource ctCallDate}" AllowGrouping="False"  />

                    <dxg:GridColumn FieldName="PhoneNumber" Header="شماره" Name="colPhoneNumber" />
                    <!--<dxg:GridColumn FieldName="TeleCode" Header="كد مخابراتی" Name="colTeleCode" CellTemplate="{StaticResource ctTeleCode}"/>-->
                    <dxg:GridColumn FieldName="TeleCode2" Header="كد مخابراتی" Name="colTeleCode2" />

                    <dxg:GridColumn FieldName="ExtraDialed" Header="مازاد" Name="colExtraDialed" />
                    <dxg:GridColumn FieldName="DurationSeconds" Header="مدت" Name="colDurationSeconds" CellTemplate="{StaticResource ctDurationSeconds}"/>
                    <dxg:GridColumn FieldName="LineNumber" Header="خط" Name="colLineNumber" CellTemplate="{StaticResource ctLine}" />
                    <dxg:GridColumn FieldName="InternalString" Header="داخلی" Name="colInternalString" CellTemplate="{StaticResource ctLine}" AllowSorting="False" Visible="{Binding DeviceHasInternal}" AllowGrouping="False" />
                    <dxg:GridColumn FieldName="LastExt" Header="آخرین" Name="colLastExt" CellTemplate="{StaticResource ctCallExtToName}" AllowSorting="False" Visible="{Binding DeviceHasInternal}" />

                    <dxg:GridColumn FieldName="RecordEnable" Header="صدا" Name="colRecordTag" CellTemplate="{StaticResource ctCallRecordTag}" AllowSorting="False" Visible="{Binding DeviceHasRecord}" />
                    <dxg:GridColumn FieldName="RecordRole" Header="ق.ح" Name="colRecordRole" CellTemplate="{StaticResource ctCallRecordRole}" AllowSorting="False" Visible="{Binding DeviceHasRecord}" />


                    <dxg:GridColumn FieldName="NoteText" Header="نكته" Name="colNoteText"/>
                    <dxg:GridColumn FieldName="NoteFlag" Name="colNoteFlag" CellTemplate="{StaticResource ctNoteFlag}" ColumnChooserHeaderCaption="پرچم" Header="پرچم">
                        <dxg:GridColumn.FilterEditorHeaderTemplate>
                            <DataTemplate>
                                <TextBlock Text="پرچم"/>
                            </DataTemplate>
                        </dxg:GridColumn.FilterEditorHeaderTemplate>
                    </dxg:GridColumn>
                    <dxg:GridColumn FieldName="NoteWriter" Header="كاربر" Name="colNoteWriter"/>
                </dxg:GridControl.Columns>
                <dxg:GridControl.View>
                    <dxg:TableView  Name="tvCall"

                                                AllowGrouping="false"
                                                AllowColumnFiltering="true"
                                                AllowFilterEditor="false"
                                                AllowEditing="False"

                                                ShowGroupPanel="false"
                                                ShowIndicator="False"
                                                ShowTotalSummary="True"
                                                

                                                IsGroupPanelMenuEnabled="True"
                                                IsColumnMenuEnabled="True"
                                                IsTotalSummaryMenuEnabled="False"

                                                MultiSelectMode="Row"

                                                BestFitArea="All"
                                                BestFitMode="VisibleRows"

                                                FocusedRow="{Binding FocusedCall,Mode=TwoWay}"

                                                RowAnimationKind="None"
                                                UseAnimationWhenExpanding="False" 
                                                ShowSearchPanelMode="Never"
                                                >
                        <!--PrintHeaderTemplate="{StaticResource RTLPrintHeaderTemplate}"
                                                PrintGroupRowTemplate="{StaticResource RTLPrintGroupRowTemplate}"
                                                PrintRowTemplate="{StaticResource RTLPrintRowTemplate}"
                                                PrintFooterTemplate="{StaticResource RTLPrintFooterTemplate}"-->

                        <!--<dxg:TableView.PrintTotalSummaryStyle>
                            <Style TargetType="dxe:BaseEdit" BasedOn="{StaticResource RTLPrintTotalSummaryStyle}">
                                <Setter Property="HorizontalContentAlignment" Value="Right" />
                                <Setter Property="FontFamily" Value="{DynamicResource ApplicationFontFamily}" />
                                <Setter Property="FontSize" Value="{DynamicResource ApplicationFontSize}" />
                            </Style>
                        </dxg:TableView.PrintTotalSummaryStyle>
                        <dxg:TableView.PrintColumnHeaderStyle>
                            <Style TargetType="dxe:BaseEdit" BasedOn="{StaticResource RTLPrintColumnHeaderStyle}">
                                <Setter Property="HorizontalContentAlignment" Value="Right" />
                                <Setter Property="FontFamily" Value="{DynamicResource ApplicationFontFamily}" />
                                <Setter Property="FontSize" Value="{DynamicResource ApplicationFontSize}" />
                            </Style>
                        </dxg:TableView.PrintColumnHeaderStyle>
                        <dxg:TableView.PrintCellStyle>
                            <Style  BasedOn="{StaticResource RTLPrintCellStyle}" TargetType="dxe:BaseEdit">
                                <Setter Property="HorizontalContentAlignment" Value="Left" />
                                <Setter Property="FontFamily" Value="{DynamicResource ApplicationFontFamily}" />
                                <Setter Property="FontSize" Value="{DynamicResource ApplicationFontSize}" />
                                <Setter Property="BorderThickness" Value="0,0,1,0" />
                                <Setter Property="HorizontalAlignment" Value="Left"/>
                            </Style>
                        </dxg:TableView.PrintCellStyle>-->
                        <dxg:TableView.CellStyle>
                            <Style TargetType="dxg:CellContentPresenter">
                                <Setter Property="FontFamily" Value="{DynamicResource ApplicationFontFamily}" />
                                <Setter Property="FontSize" Value="{DynamicResource ApplicationFontSize}" />
                            </Style>
                        </dxg:TableView.CellStyle>
                        <dxg:TableView.TotalSummaryContentStyle>
                            <Style TargetType="dx:DataContentPresenter">
                                <Setter Property="HorizontalAlignment" Value="Stretch" />
                            </Style>
                        </dxg:TableView.TotalSummaryContentStyle>

                        <dxg:TableView.RowCellMenuCustomizations>
                            <dxb:BarButtonItemLink BarItemName="biSetCallNote"/>
                            <dxb:BarItemLinkSeparator/>
                            <dxb:BarButtonItemLink BarItemName="biCallDeleteSingle"/>
                            <dxb:BarButtonItemLink BarItemName="biCallDeleteAll"/>
                            <dxb:BarItemLinkSeparator/>
                            <dxb:BarSubItem Content="ضبط مكالمات" >
                                <dxb:BarButtonItemLink BarItemName="biVoicePlay"/>
                                <dxb:BarButtonItemLink BarItemName="biVoiceSave"/>
                                <dxb:BarButtonItemLink BarItemName="biVoiceDelete"/>
                                <dxb:BarItemLinkSeparator/>
                                <dxb:BarButtonItemLink BarItemName="biVoiceRole1"/>
                                <dxb:BarButtonItemLink BarItemName="biVoiceRole2"/>
                                <dxb:BarButtonItemLink BarItemName="biVoiceRole3"/>
                            </dxb:BarSubItem>
                        </dxg:TableView.RowCellMenuCustomizations>
                    </dxg:TableView>
                </dxg:GridControl.View>
            </dxg:GridControl>
        </Grid>
    </dxb:BarManager>
</UserControl>
