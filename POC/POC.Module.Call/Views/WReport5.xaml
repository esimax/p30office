<dx:DXWindow x:Class="POC.Module.Call.Views.WReport5"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
        
        xmlns:pol_ap="clr-namespace:POL.WPF.Controles.AttachProperties;assembly=POL.WPF.Controles"
        xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
        xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
        xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"

        Title="گزارش آخرین تماس پرونده ها"
        
        Height="600" Width="800"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize" 
             
        Icon="{DynamicResource ApplicationIcon}"
        FontFamily="{DynamicResource ApplicationFontFamily}" 
        FontSize="{DynamicResource ApplicationFontSize}"
        >
    <dx:DXWindow.Resources>
        <DataTemplate x:Key="LeftToRightTemplate">
            <TextBlock 
                    Margin="1" 
                    VerticalAlignment="Center" 
                    HorizontalAlignment="Right" 
                    FlowDirection="LeftToRight" 
                    Text="{Binding DataContext.Value, RelativeSource={RelativeSource TemplatedParent}}"/>
        </DataTemplate>
    </dx:DXWindow.Resources>
    <Grid pol_ap:ApGrid.RowDefinitions="auto,*,auto" 
          pol_ap:ApGrid.ColumnDefinitions="*" Margin="9" 
          FlowDirection="{DynamicResource ApplicationFlowDirection}">
        <StackPanel Grid.Row="0" Grid.Column="0" Orientation="Horizontal" Margin="3">
            <TextBlock Margin="3" VerticalAlignment="Center" Text="دسته :"/>
            <dxe:ComboBoxEdit Name="cbeContactCat" Margin="3" IsTextEditable="False"  Width="300" AllowSpinOnMouseWheel="False"
                                      ApplyItemTemplateToSelectedItem="True" 
                                      NullText="(همه دسته ها)">
                <dxe:ComboBoxEdit.Buttons>
                    <dxe:ButtonInfo GlyphKind="Refresh" ToolTip="بازخوانی مجدد" Name="biRefresh"/>
                </dxe:ComboBoxEdit.Buttons>
                <dxe:ComboBoxEdit.EditNonEditableTemplate>
                    <ControlTemplate>
                        <TextBlock Text="{Binding EditValue}" Margin="3"/>
                    </ControlTemplate>
                </dxe:ComboBoxEdit.EditNonEditableTemplate>
            </dxe:ComboBoxEdit>
            <Button Margin="3" Content="محاسبه" Width="75" Name="bCalculate"/>
        </StackPanel>

        <dxg:GridControl Grid.Row="1" x:Name="gcMain" Margin="3">
            <dxg:GridControl.TotalSummary>
                <dxg:GridSummaryItem DisplayFormat=" {0}" FieldName="ContactTitle" ShowInColumn="ContactTitle" SummaryType="Count" />
            </dxg:GridControl.TotalSummary>
            <dxg:GridControl.Columns>
                <dxg:GridColumn Name="colContactCode" Width="65" FieldName="ContactCode" Header="كد پرونده"/>
                <dxg:GridColumn Name="colContactTitle" FieldName="ContactTitle" Header="عنوان"/>
                <dxg:GridColumn Name="colPhoneNumber" FieldName="PhoneNumber" Header="شماره" CellTemplate="{StaticResource LeftToRightTemplate}"/>
                <dxg:GridColumn Name="colLastLine" FieldName="LastLine" Header="خط" />

                <dxg:GridColumn Name="colLastCallDateInOutContact" FieldName="LastCallDateInOutContact" Header="تاریخ آخرین تماس"/>
                <dxg:GridColumn Name="colLastCallAsDays" FieldName="LastCallAsDays" Header="روز گذشته"/>
                
                <dxg:GridColumn Name="colLastExt" FieldName="LastExt" Header="داخلی"/>
                <dxg:GridColumn Name="colLastCallType" FieldName="LastCallType" Header="نوع تماس"/>
            </dxg:GridControl.Columns>
            <dxg:GridControl.View>
                <dxg:TableView Name="tvMain"
                               AllowCascadeUpdate="False"
                               AllowColumnFiltering="True"
                               AllowEditing="False"
                               AllowFilterEditor="True"
                               AllowGrouping="True"
                               AllowPerPixelScrolling="True"
                                   
                               BestFitMode="VisibleRows"
                               BestFitArea="All"
                               
                               IsColumnMenuEnabled="True"
                               IsGroupPanelMenuEnabled="True"
                               IsTotalSummaryMenuEnabled="False"
                               MultiSelectMode="Row"
                               ShowGroupPanel="True"
                               ShowIndicator="False"
                               ShowTotalSummary="True" 
                               ShowSearchPanelMode="Never"
                               AutoWidth="False"    
                               ShowColumnHeaders="True" 
                               >
                </dxg:TableView>
            </dxg:GridControl.View>
        </dxg:GridControl>

        <StackPanel Grid.Row="2" Grid.ColumnSpan="1" Orientation="Horizontal" Margin="3" HorizontalAlignment="Right">
            <Button Margin="0" Padding="6,3" MinWidth="80" IsDefault="True" Name="bExport">
                <StackPanel Orientation="Horizontal">
                    <!--<Image Style="{DynamicResource ImageOK16}" />-->
                    <TextBlock Margin="3" VerticalAlignment="Center" Text="استخراج به اكسل"/>
                </StackPanel>
            </Button>
            <Button Margin="12,0,0,0" Padding="6,3" MinWidth="80" IsCancel="True" Name="bCancel">
                <StackPanel Orientation="Horizontal">
                    <Image Style="{DynamicResource ImageCancel16}" />
                    <TextBlock Margin="3" VerticalAlignment="Center" Text="لغو"/>
                </StackPanel>
            </Button>
            <Button Margin="12,0,0,0" Padding="6,3" MinWidth="80" Name="bHelp">
                <StackPanel Orientation="Horizontal">
                    <Image Style="{DynamicResource ImageHelp16}" />
                    <TextBlock Margin="3" VerticalAlignment="Center" Text="راهنما"/>
                </StackPanel>
            </Button>
        </StackPanel>
    </Grid>
</dx:DXWindow>
