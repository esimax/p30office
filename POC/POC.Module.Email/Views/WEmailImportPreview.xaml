<dx:DXWindow
    x:Class="POC.Module.Email.Views.WEmailImportPreview"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
    Height="600" Width="800"
    
    Title="{Binding WindowTitle}"
    Icon="{DynamicResource ApplicationIcon}"
    
    xmlns:pol_ap="clr-namespace:POL.WPF.Controles.AttachProperties;assembly=POL.WPF.Controles"
    xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
    xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
    xmlns:pol_conv="clr-namespace:POL.WPF.Controles.Conv;assembly=POL.WPF.Controles"
    xmlns:local="clr-namespace:POC.Module.Email.Models" 
    xmlns:dxgt="http://schemas.devexpress.com/winfx/2008/xaml/grid/themekeys"
    
    WindowStartupLocation="CenterScreen"
    ResizeMode="NoResize" 
    
    FontFamily="{DynamicResource ApplicationFontFamily}" 
    FontSize="{DynamicResource ApplicationFontSize}"
    >
    <dx:DXWindow.Resources>
        <local:ConvImportToVisibility x:Key="ConvImportToVisibility"/>
        <local:ConvImportToText x:Key="ConvImportToText"/>
    </dx:DXWindow.Resources>

    <Grid pol_ap:ApGrid.RowDefinitions="auto,*,auto,auto,auto,auto"
          pol_ap:ApGrid.ColumnDefinitions="auto,*" 
          FlowDirection="{DynamicResource ApplicationFlowDirection}">

        <TextBlock Margin="3" Text="پیش نمایش اطلاعات جهت ورود به پایگاه اطلاعات" Grid.ColumnSpan="2"/>
        <dxg:GridControl Grid.Row="1" Grid.ColumnSpan="2" Margin="3" ItemsSource="{Binding ImportList}">
            <!--<dxg:GridControl.Resources>
                <Style x:Key="myRowStyle" BasedOn="{StaticResource {dxgt:GridRowThemeKey ResourceKey=RowStyle}}" TargetType="{x:Type dxg:GridRowContent}">
                    <Setter Property="Height" Value="26" />
                </Style>
            </dxg:GridControl.Resources>-->
            <dxg:GridControl.TotalSummary>
                <dxg:GridSummaryItem DisplayFormat="تعداد: {0}" FieldName="ContactCode" ShowInColumn="ContactTitle" SummaryType="Count" />
            </dxg:GridControl.TotalSummary>
            <dxg:GridControl.Columns>
                <dxg:GridColumn Name="colRow" FieldName="Row"  Header="ردیف" HorizontalHeaderContentAlignment="Center" VisibleIndex="0" />
                <dxg:GridColumn Name="colContactCode" FieldName="ContactCode"  Header="كد پرونده" HorizontalHeaderContentAlignment="Center" VisibleIndex="1" />
                <dxg:GridColumn Name="colContactTitle" FieldName="ContactTitle"  Header="عنوان پرونده" HorizontalHeaderContentAlignment="Center" VisibleIndex="2" />
                <dxg:GridColumn Name="colEmailAddress" FieldName="Address"  Header="آدرس" HorizontalHeaderContentAlignment="Center" VisibleIndex="3" />
                <dxg:GridColumn Name="colError" FieldName="ErrorType"  Header="وضعیت" HorizontalHeaderContentAlignment="Center" VisibleIndex="4" >
                    <dxg:GridColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel VerticalAlignment="Center" Orientation="Horizontal">
                                <Image Stretch="None" 
                                       Margin="1"
                                       Width="16" 
                                       Height="16" 
                                       Source="pack://application:,,,/POL.Lib.Resources;component/Standard/16/_16_Warning.png"
                                       RenderOptions.BitmapScalingMode="NearestNeighbor"
                                       Visibility="{Binding Path='RowData.Row',Converter={StaticResource ConvImportToVisibility}}"
                                       />
                                <TextBlock Margin="3" Text="{Binding Path='RowData.Row',Converter={StaticResource ConvImportToText}}"/>
                            </StackPanel>
                        </DataTemplate>
                    </dxg:GridColumn.CellTemplate>
                </dxg:GridColumn>
                <dxg:GridColumn Name="colEmailTitle" FieldName="Title"  Header="عنوان" HorizontalHeaderContentAlignment="Center" VisibleIndex="5" />
            </dxg:GridControl.Columns>
            <dxg:GridControl.View>
                <dxg:TableView AllowColumnFiltering="False" AllowEditing="False" AllowFilterEditor="False" AutoWidth="False"
                       AllowGrouping="False" IsColumnMenuEnabled="True"
                       IsGroupPanelMenuEnabled="False" IsTotalSummaryMenuEnabled="False" Name="tvMain" ShowGroupPanel="False"
                       ShowIndicator="False" ShowTotalSummary="True" MultiSelectMode="Row" BestFitMode="VisibleRows" />
                <!--RowStyle="{StaticResource myRowStyle}"-->

            </dxg:GridControl.View>
        </dxg:GridControl>

        <TextBlock  Grid.Row="2" Margin="3" Text="تعداد خطا :"/>
        <TextBlock  Grid.Row="2" Grid.Column="1" Margin="3" Text="{Binding ImportErrorCount}"/>

        <TextBlock  Grid.Row="3" Margin="3" Text="تعداد آدرس های اضافه شده :"/>
        <TextBlock  Grid.Row="3" Grid.Column="1" Margin="3" Text="{Binding ImportEmailAdded}"/>

        <TextBlock  Grid.Row="4" Margin="3" Text="تعداد پرونده های جدید :"/>
        <TextBlock  Grid.Row="4" Grid.Column="1" Margin="3" Text="{Binding ImportContactAdded}"/>

        <StackPanel Grid.Row="5" Grid.ColumnSpan="2">
            <Button Margin="9" Content="شروع" Command="{Binding CommandStartImport}"  IsDefault="True" Click="Button_Click_1" />
        </StackPanel>

    </Grid>
</dx:DXWindow>
